<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <!-- penting untuk iPhone notch -->
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <title>Digineer Store - Solusi Digital Profesional & Jasa Kreatif</title>
  <meta name="description" content="Jasa desain profesional, development website, digital marketing, dan solusi kreatif untuk transformasi bisnis Anda." />
  <meta name="robots" content="index,follow" />
  <link rel="canonical" href="https://example.com/" />
  <meta property="og:title" content="Digineer Store - Solusi Digital Profesional" />
  <meta property="og:description" content="Jasa desain, website, dan digital marketing untuk transformasi bisnismu." />
  <meta property="og:image" content="https://example.com/og-cover.jpg" />
  <meta property="og:url" content="https://example.com/" />
  <meta name="twitter:card" content="summary_large_image" />
  <link rel="manifest" href="/manifest.json" />
  <meta name="theme-color" content="#10bfa4" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-title" content="Digineer Store" />
  <link rel="icon" href="assets/favicon.ico" />

  <!-- Perf -->
  <link rel="preconnect" href="https://fonts.googleapis.com" crossorigin />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link rel="preload" as="style" href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800&display=swap" />
  <link rel="preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />

  <!-- Fonts & Icons -->
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800&display=swap" rel="stylesheet" />
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet" />

  <style>
    /* ========= TOKENS (match warna logo: teal/turquoise) ========= */
    :root{
      --primary:#10bfa4;        /* teal utama */
      --primary-600:#0ea894;    /* teal lebih gelap */
      --accent:#12d3b7;         /* aksen terang */
      --ink:#0b1220;            /* teks utama (gelap) */
      --muted:#63707f;          /* teks sekunder */
      --bg:#f7faf9;             /* latar */
      --surface:#ffffff;        /* kartu/permukaan */
      --border:#e5e9ec;         /* garis halus */
      --success:#0fb985; --error:#ef4444;

      --container:1120px;
      --header-h:64px;
      --radius:14px; --radius-sm:10px;
      --shadow:0 6px 20px rgba(2,8,23,.08);
      --shadow-sm:0 2px 10px rgba(2,8,23,.06);
      --transition:all .25s ease;

      --space-1:.25rem; --space-2:.5rem; --space-3:.75rem; --space-4:1rem; --space-5:1.25rem;
      --space-6:1.5rem; --space-8:2rem; --space-10:2.5rem; --space-12:3rem; --space-16:4rem; --space-24:6rem;
    }

    /* ========= RESET ========= */
    *{margin:0;padding:0;box-sizing:border-box}
    html,body{height:100%}
    html{-webkit-text-size-adjust:100%}
    body{
      font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;
      background:var(--bg); color:var(--ink); line-height:1.6;
      -webkit-tap-highlight-color:transparent;
      padding-top:calc(var(--header-h) + env(safe-area-inset-top, 0px)); /* beri ruang untuk header fixed */
    }
    input,select,textarea{font-size:16px} /* cegah auto-zoom Safari */

    /* ========= SKIP LINK ========= */
    .skip-link{position:absolute;left:-9999px;top:0;background:#111;color:#fff;padding:.5rem .75rem;border-radius:10px}
    .skip-link:focus{left:.75rem;top:.75rem;z-index:9999}

    /* ========= HEADER (fix iPhone + badge tidak kepotong) ========= */
    .header{
      position:fixed; left:0; right:0; top:0; z-index:1000;
      height:calc(var(--header-h) + env(safe-area-inset-top,0px));
      padding-top:env(safe-area-inset-top,0px);
      background:rgba(255,255,255,.94);
      border-bottom:1px solid var(--border);
      -webkit-backdrop-filter:saturate(180%) blur(14px);
      backdrop-filter:saturate(180%) blur(14px);
    }
    .nav{
      max-width:var(--container);
      margin:0 auto;
      height:var(--header-h);
      padding:0 var(--space-6);
      display:grid;
      grid-template-columns:auto 1fr auto;
      align-items:center;
      gap:var(--space-4);
      overflow:visible; /* penting untuk badge */
    }

    /* Brand kiri */
    .brand{display:flex;align-items:center;gap:.65rem;text-decoration:none;white-space:nowrap}
    .brand img{height:28px;width:auto;display:block}      /* lebih pas di HP */
    .brand span{font-weight:800;letter-spacing:.2px;color:var(--primary);font-size:1.25rem}

    /* Link tengah (disembunyikan di mobile) */
    .links{display:flex;gap:var(--space-6);justify-self:center;white-space:nowrap}
    .nav-link{font-weight:600;text-decoration:none;color:#0b1220b3;padding:.25rem .25rem;border-radius:8px}
    .nav-link:hover{color:var(--primary)}

    /* Ikon kanan */
    .actions{
      display:flex; gap:.5rem; align-items:center; flex-wrap:nowrap;
      overflow:visible; /* jangan kepotong */
    }
    .icon-btn{
      width:44px;height:44px; /* tap target >=44px */
      border:1px solid var(--border); background:var(--surface);
      border-radius:999px; display:grid; place-items:center;
      cursor:pointer; transition:var(--transition); position:relative; flex:0 0 auto;
    }
    .icon-btn:hover{transform:translateY(-1px);border-color:#d1d8de;box-shadow:var(--shadow-sm);color:var(--primary)}
    .badge{
      position:absolute; right:-6px; top:-6px;
      background:var(--accent); color:#043a33;
      border:1px solid #8bf0e1; border-radius:999px;
      min-width:18px; height:18px; padding:0 6px;
      display:grid; place-items:center; font-size:.7rem; font-weight:800;
    }
    .hamburger{display:none}
    .drawer{display:none}

    /* ========= HERO ========= */
    .hero{
      position:relative;
      background:
        radial-gradient(1200px 600px at 20% -10%, rgba(16,191,164,.35) 0%, rgba(16,191,164,0) 60%),
        linear-gradient(140deg,#14b8a6 0%, #0ea894 28%, #0b1220 85%);
      color:#fff;
      scroll-margin-top: calc(var(--header-h) + 12px);
    }
    .hero-inner{max-width:var(--container);margin:0 auto;padding:var(--space-24) var(--space-6) var(--space-24);text-align:center}
    .hero h1{font-weight:800;line-height:1.08;letter-spacing:.2px;font-size:clamp(2rem,3.6vw,3.25rem)}
    .hero h1 .sub{display:block;color:#bdf6ed}
    .hero p{opacity:.98;margin-top:var(--space-4);font-size:clamp(1rem,1.5vw,1.125rem)}
    .cta{display:flex;gap:var(--space-3);justify-content:center;margin-top:var(--space-6);flex-wrap:wrap}
    .btn{display:inline-flex;align-items:center;gap:.5rem;border:none;border-radius:12px;font-weight:800;cursor:pointer;transition:var(--transition);padding:.9rem 1.15rem;min-height:44px}
    .btn-primary{background:#0b1220;color:#e6fffb;border:1px solid #1b2a39}
    .btn-primary:hover{transform:translateY(-2px);box-shadow:var(--shadow);background:#101a27}
    .btn-ghost{background:rgba(255,255,255,.08);color:#ecfffd;border:1px solid rgba(255,255,255,.22)}
    .btn-ghost:hover{background:rgba(255,255,255,.16);transform:translateY(-2px)}

    /* ========= PRODUCTS ========= */
    .section{padding:var(--space-24) 0}
    .container{max-width:var(--container);margin:0 auto;padding:0 var(--space-6)}
    .section-title{font-size:clamp(1.75rem,2.4vw,2.25rem);text-align:center;font-weight:800;margin-bottom:var(--space-12);background:linear-gradient(135deg,#0ea894,#0b1220);-webkit-background-clip:text;-webkit-text-fill-color:transparent}
    .tools{display:flex;flex-wrap:wrap;gap:var(--space-4);justify-content:space-between;align-items:center;margin-bottom:var(--space-8)}
    .search{position:relative;min-width:280px;flex:1}
    .search input{width:100%;padding:1rem 1rem 1rem 3rem;border:1px solid var(--border);border-radius:12px;background:#fff;font-size:16px}
    .search i{position:absolute;left:1rem;top:50%;transform:translateY(-50%);color:var(--muted)}
    .filters{display:flex;flex-wrap:wrap;gap:.5rem}
    .chip{padding:.65rem 1.1rem;border:1px solid var(--border);background:#fff;border-radius:999px;font-weight:700;cursor:pointer;transition:var(--transition);min-height:40px}
    .chip.active{background:var(--primary);border-color:var(--primary);color:#072d28}

    .grid{display:grid;grid-template-columns:repeat(12,1fr);gap:var(--space-6)}
    .col{grid-column:span 4}
    @media (max-width:1024px){ .col{grid-column:span 6} }
    @media (max-width:640px){ .col{grid-column:span 12} }

    .card{background:var(--surface);border:1px solid var(--border);border-radius:var(--radius);overflow:hidden;box-shadow:var(--shadow-sm);transition:var(--transition);display:flex;flex-direction:column;height:100%}
    .card:hover{transform:translateY(-4px);box-shadow:var(--shadow)}
    .cover{width:100%;height:204px;object-fit:cover;display:block}
    .card-body{padding:var(--space-6);display:flex;flex-direction:column;gap:var(--space-3);flex:1}
    .cat{color:var(--primary);text-transform:uppercase;letter-spacing:.08em;font-size:.8rem;font-weight:800}
    .title{font-weight:800;font-size:1.1rem;line-height:1.35;display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical;overflow:hidden;min-height:3rem}
    .desc{color:var(--muted);font-size:.97rem;display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical;overflow:hidden;min-height:3rem}

    .meta{margin-top:auto;display:flex;align-items:center;justify-content:space-between;gap:var(--space-3)}
    .price{font-weight:900;color:#0a8f7e;font-size:1.25rem}
    .actions{display:flex;gap:.5rem;align-items:center;flex-wrap:wrap;justify-content:flex-end}

    /* tombol Beli */
    .btn-buy{display:inline-flex;align-items:center;gap:.5rem;padding:.65rem 1rem;border-radius:12px;border:1px solid #8bf0e1;background:var(--primary);color:#053b34;font-weight:800;cursor:pointer;transition:var(--transition)}
    .btn-buy:hover{background:var(--primary-600);transform:translateY(-2px)}
    .round{width:42px;height:42px;border:none;border-radius:12px;display:grid;place-items:center;cursor:pointer;transition:var(--transition)}
    .round.wish{background:#edf7f6;color:#537872;border:1px solid #d6ece9}
    .round.wish.active{background:var(--accent);color:#053b34;border-color:#8bf0e1}
    .round:hover{transform:translateY(-2px)}

    /* ========= CART ========= */
    .overlay{position:fixed;inset:0;background:rgba(11,18,32,.45);opacity:0;visibility:hidden;transition:var(--transition);z-index:998}
    .overlay.active{opacity:1;visibility:visible}
    .cart{position:fixed;top:0;right:-420px;width:min(94vw,400px);height:100vh;background:#fff;border-left:1px solid var(--border);box-shadow:var(--shadow);z-index:999;transition:var(--transition);display:flex;flex-direction:column}
    .cart.active{right:0}
    .cart-h{padding:var(--space-6);display:flex;align-items:center;justify-content:space-between;border-bottom:1px solid var(--border)}
    .cart-b{flex:1;overflow:auto;padding:var(--space-6);display:flex;flex-direction:column;gap:var(--space-4)}
    .cart-i{display:flex;gap:var(--space-4);background:#f4fbfa;border:1px solid var(--border);border-radius:var(--radius-sm);padding:var(--space-4)}
    .cart-i img{width:64px;height:64px;object-fit:cover;border-radius:10px}
    .cart-f{border-top:1px solid var(--border);padding:var(--space-6);display:flex;flex-direction:column;gap:var(--space-4)}
    .ttl{display:flex;justify-content:space-between;font-weight:900;font-size:1.15rem}
    .btn-check{padding:1rem;border:none;border-radius:12px;background:var(--primary);color:#053b34;font-weight:900;cursor:pointer;transition:var(--transition);border:1px solid #8bf0e1}
    .btn-check:hover{background:var(--primary-600)}

    /* ========= NOTIFICATION ========= */
    .note{position:fixed;top:calc(var(--header-h) + 24px);right:16px;background:#fff;border-left:4px solid var(--primary);box-shadow:var(--shadow);border-radius:12px;padding:.9rem 1.1rem;display:flex;align-items:center;gap:.75rem;transform:translateX(420px);transition:transform .3s ease;z-index:1001}
    .note.show{transform:translateX(0)}
    .note.success{border-left-color:var(--success)}
    .note.error{border-left-color:var(--error)}

    /* ========= SKELETON ========= */
    .sk{background:linear-gradient(90deg,#eef6f5 25%,#f8fdfc 37%,#eef6f5 63%);background-size:400% 100%;animation:shimmer 1.2s ease infinite;border-radius:12px}
    @keyframes shimmer{0%{background-position:100% 0}100%{background-position:-100% 0}}
    .sk-card{border:1px solid var(--border);background:#fff;border-radius:var(--radius);box-shadow:var(--shadow-sm);overflow:hidden}
    .sk-img{height:204px}
    .sk-body{padding:var(--space-6)}
    .sk-line{height:14px;margin:.6rem 0}

    /* ========= FOOTER ========= */
    footer{margin-top:var(--space-24);background:#fff;border-top:1px solid var(--border)}
    .foot{max-width:var(--container);margin:0 auto;padding:var(--space-8) var(--space-6);display:flex;flex-wrap:wrap;align-items:center;justify-content:space-between;gap:var(--space-4);color:var(--muted)}
    .foot .brand-mini{display:flex;align-items:center;gap:.6rem}
    .foot .brand-mini img{height:20px}
    .social{display:flex;gap:12px}
    .social a{display:inline-flex;align-items:center;justify-content:center;width:36px;height:36px;border:1px solid var(--border);border-radius:10px;color:#3a4a50;text-decoration:none;transition:var(--transition)}
    .social a:hover{color:var(--primary);border-color:#8bf0e1;box-shadow:var(--shadow-sm)}

    /* ========= A11Y & MOBILE NAV ========= */
    :focus-visible{outline:3px solid var(--primary);outline-offset:2px}
    @media (prefers-reduced-motion:reduce){*{animation:none!important;transition:none!important}}
    @media (max-width:768px){
      .links{display:none}
      .hamburger{display:inline-grid;place-items:center}
      .brand img{height:26px}
      .drawer{
        display:block; position:fixed;
        top: calc(var(--header-h) + env(safe-area-inset-top,0px));
        left:0; right:0; background:#fff; border-bottom:1px solid var(--border);
        transform: translateY(-120%); transition: var(--transition); z-index:999;
      }
      .drawer.open{ transform: translateY(0); }
      .drawer a{ display:block; padding:1rem var(--space-6); border-top:1px solid var(--border); text-decoration:none; color:#0b1220 }
      .drawer a:active{ background:#f4fbfa }
    }
  </style>
</head>
<body>
  <a href="#produk" class="skip-link">Lewati ke konten</a>

  <!-- ========= HEADER ========= -->
  <header class="header" role="banner">
    <nav class="nav" aria-label="Navigasi utama">
      <a class="brand" href="#home" aria-label="Digineer Store">
        <img src="assets/logo.png" alt="Digineer Store" width="144" height="32"
             decoding="async" fetchpriority="high"
             onerror="this.onerror=null;this.src='https://via.placeholder.com/144x32?text=Digineer'">
        <span>Digineer</span>
      </a>

      <div class="links" role="menubar">
        <a class="nav-link" role="menuitem" href="#home">Home</a>
        <a class="nav-link" role="menuitem" href="#produk">Produk</a>
        <a class="nav-link" role="menuitem" href="#about">Tentang</a>
        <a class="nav-link" role="menuitem" href="#contact">Kontak</a>
      </div>

      <div class="actions">
        <button class="icon-btn hamburger" id="btnMenu" aria-label="Buka menu" aria-expanded="false">
          <i class="fas fa-bars"></i>
        </button>
        <button class="icon-btn" aria-label="Buka wishlist">
          <i class="far fa-heart"></i>
          <span class="badge" id="wishlistBadge">0</span>
        </button>
        <button class="icon-btn" aria-label="Buka keranjang" onclick="toggleCart()">
          <i class="fas fa-cart-shopping"></i>
          <span class="badge" id="cartBadge">0</span>
        </button>
        <a href="admin.html" class="icon-btn" aria-label="Halaman admin">
          <i class="fas fa-user-cog"></i>
        </a>
      </div>
    </nav>

    <!-- Drawer mobile -->
    <div class="drawer" id="drawer" aria-label="Menu mobile">
      <a href="#home" onclick="closeDrawer()">Home</a>
      <a href="#produk" onclick="closeDrawer()">Produk</a>
      <a href="#about" onclick="closeDrawer()">Tentang</a>
      <a href="#contact" onclick="closeDrawer()">Kontak</a>
    </div>
  </header>

  <!-- ========= HERO ========= -->
  <section class="hero" id="home" role="region" aria-label="Hero">
    <div class="hero-inner">
      <h1>Solusi Digital <span class="sub">Profesional</span></h1>
      <p>Jasa desain, development website, dan solusi kreatif untuk transformasi bisnis Anda dengan tim ahli berpengalaman.</p>
      <div class="cta">
        <button class="btn btn-primary" onclick="scrollToProducts()"><i class="fas fa-rocket"></i> Jelajahi Layanan</button>
        <button class="btn btn-ghost" onclick="showNotification('Fitur konsultasi akan segera hadir!', 'info')"><i class="fas fa-comments"></i> Konsultasi Gratis</button>
      </div>
    </div>
  </section>

  <!-- ========= PRODUCTS ========= -->
  <section class="section" id="produk" role="region" aria-label="Layanan Kami">
    <div class="container">
      <h2 class="section-title">Layanan Kami</h2>

      <div class="tools">
        <div class="search">
          <i class="fas fa-search" aria-hidden="true"></i>
          <input id="searchInput" type="text" placeholder="Cari layanan..." aria-label="Cari layanan" oninput="onSearch(this.value)">
        </div>
        <div class="filters" role="tablist" aria-label="Filter kategori">
          <button class="chip active" role="tab" aria-selected="true" onclick="filterProducts('all', this)">Semua</button>
          <button class="chip" role="tab" aria-selected="false" onclick="filterProducts('design', this)">Desain</button>
          <button class="chip" role="tab" aria-selected="false" onclick="filterProducts('development', this)">Development</button>
          <button class="chip" role="tab" aria-selected="false" onclick="filterProducts('video', this)">Video</button>
        </div>
      </div>

      <div class="grid" id="productsContainer" aria-live="polite" aria-busy="true"></div>
    </div>
  </section>

  <!-- ========= CART ========= -->
  <div class="overlay" id="overlay" onclick="toggleCart()" aria-hidden="true"></div>
  <aside class="cart" id="cart" aria-label="Keranjang Belanja">
    <div class="cart-h">
      <strong>Keranjang Belanja</strong>
      <button class="icon-btn" aria-label="Tutup keranjang" onclick="toggleCart()"><i class="fas fa-times"></i></button>
    </div>
    <div class="cart-b" id="cartItems"></div>
    <div class="cart-f">
      <div class="ttl"><span>Total</span><span id="cartTotal">Rp 0</span></div>
      <button class="btn-check" onclick="checkout()"><i class="fas fa-credit-card"></i> Checkout Sekarang</button>
    </div>
  </aside>

  <!-- Live region untuk SR -->
  <div id="liveRegion" aria-live="polite" aria-atomic="true" style="position:absolute;left:-9999px;width:1px;height:1px;overflow:hidden;"></div>

  <!-- ========= FOOTER ========= -->
  <footer role="contentinfo">
    <div class="foot">
      <div class="brand-mini">
        <img src="assets/logo.png" alt="Digineer" onerror="this.onerror=null;this.src='https://via.placeholder.com/120x24?text=Digineer'">
        <span>¬© <span id="year"></span> Digineer Store</span>
      </div>
      <div class="social" aria-label="Sosial media">
        <a href="https://wa.me/6289507083879" aria-label="WhatsApp"><i class="fa-brands fa-whatsapp"></i></a>
        <a href="https://www.instagram.com/digineer_/?igsh=cmx3eW1sdXlybnk5#" aria-label="Instagram"><i class="fa-brands fa-instagram"></i></a>
        <a href="https://www.tiktok.com/@digineer?_t=ZS-90cDrIAoYOj&_r=1" aria-label="TikTok"><i class="fa-brands fa-tiktok"></i></a>
      </div>
    </div>
  </footer>

  <!-- ========= SCRIPTS ========= -->
  <script>
    /* ---------- Data ---------- */
    const products = [
      { id:'p1', name:'Paket Branding Professional', category:'design', price:2500000, image:'https://images.unsplash.com/photo-1565688534245-05d6b5be184a?auto=format&fit=crop&w=800&q=80', description:'Logo, brand guide, stationery design, dan social media kit lengkap' },
      { id:'p2', name:'Website Company Profile', category:'development', price:3500000, image:'https://images.unsplash.com/photo-1460925895917-afdab827c52f?auto=format&fit=crop&w=800&q=80', description:'Website perusahaan modern dengan CMS custom dan responsive design' },
      { id:'p3', name:'Video Company Profile', category:'video', price:5000000, image:'https://images.unsplash.com/photo-1554260570-9140fd3b7614?auto=format&fit=crop&w=800&q=80', description:'Video profil perusahaan profesional dengan animasi dan editing' },
      { id:'p4', name:'UI/UX Design', category:'design', price:1500000, image:'https://images.unsplash.com/photo-1561070791-2526d30994b5?auto=format&fit=crop&w=800&q=80', description:'Desain user interface dan experience untuk aplikasi dan website' },
      { id:'p5', name:'E-Commerce Website', category:'development', price:7500000, image:'https://images.unsplash.com/photo-1556742049-0cfed4f6a45d?auto=format&fit=crop&w=800&q=80', description:'Website toko online lengkap dengan payment gateway dan admin panel' },
      { id:'p6', name:'Social Media Content', category:'design', price:800000, image:'https://images.unsplash.com/photo-1611162617474-5b21e879e113?auto=format&fit=crop&w=800&q=80', description:'Paket konten media sosial 1 bulan dengan design yang konsisten' }
    ];

    /* ---------- State ---------- */
    let cart = JSON.parse(localStorage.getItem('digineer-cart')) || [];
    let wishlist = JSON.parse(localStorage.getItem('digineer-wishlist')) || [];
    let currentFilter = 'all';
    let currentSearch = '';
    const IDR = new Intl.NumberFormat('id-ID',{style:'currency',currency:'IDR',maximumFractionDigits:0});

    /* ---------- WhatsApp normalize ---------- */
    const WHATSAPP_NUMBER = '089507083879';
    const toWaIntl = n => { let s=(n||'').replace(/\D/g,''); if(s.startsWith('0')) s='62'+s.slice(1); if(s.startsWith('620')) s='62'+s.slice(2); return s; };
    const WAPP = toWaIntl(WHATSAPP_NUMBER);

    /* ---------- Utilities ---------- */
    const debounce = (fn, d=300)=>{ let t; return (...a)=>{ clearTimeout(t); t=setTimeout(()=>fn(...a),d); } };
    const escapeHTML = s => (s||'').replace(/[&<>"']/g, m=>({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#039;'}[m]));
    const getCategoryName = c => ({design:'Desain',development:'Development',video:'Video Production'})[c]||c;

    function syncStateToURL(){ const url=new URL(window.location); url.searchParams.set('filter', currentFilter); url.searchParams.set('q', currentSearch||''); history.replaceState({},'',url); }
    function readStateFromURL(){
      const url=new URL(window.location);
      currentFilter=url.searchParams.get('filter')||'all';
      currentSearch=url.searchParams.get('q')||'';
      const input=document.getElementById('searchInput'); if(input) input.value=currentSearch;
      document.querySelectorAll('.chip').forEach(c=>{c.classList.remove('active');c.setAttribute('aria-selected','false')});
      const idx = {all:0,design:1,development:2,video:3}[currentFilter] ?? 0;
      const chip = document.querySelectorAll('.chip')[idx]; if(chip){chip.classList.add('active');chip.setAttribute('aria-selected','true')}
    }

    /* ---------- Drawer (mobile nav) ---------- */
    const btnMenu = document.getElementById('btnMenu');
    const drawer = document.getElementById('drawer');
    function closeDrawer(){ drawer.classList.remove('open'); btnMenu.setAttribute('aria-expanded','false'); }
    btnMenu?.addEventListener('click', ()=>{ const open = drawer.classList.toggle('open'); btnMenu.setAttribute('aria-expanded', String(open)); });

    /* ---------- Skeleton ---------- */
    function showSkeleton(n=6){
      const grid=document.getElementById('productsContainer');
      grid.setAttribute('aria-busy','true');
      grid.innerHTML = Array.from({length:n}).map(()=>`
        <div class="col"><div class="sk-card"><div class="sk sk-img"></div>
          <div class="sk-body"><div class="sk sk-line" style="width:40%"></div>
          <div class="sk sk-line" style="width:80%"></div><div class="sk sk-line" style="width:60%"></div></div>
        </div></div>`).join('');
    }

    /* ---------- Render Products ---------- */
    function renderProducts(){
      const grid=document.getElementById('productsContainer');
      let list=[...products];
      if(currentFilter!=='all'){ list=list.filter(p=>p.category===currentFilter); }
      if(currentSearch){ const q=currentSearch.toLowerCase(); list=list.filter(p=>p.name.toLowerCase().includes(q)||p.description.toLowerCase().includes(q)); }

      if(list.length===0){
        grid.innerHTML = `<div class="col" style="grid-column:1/-1;text-align:center;color:#62707f">
          <p>Tidak ada layanan yang cocok.</p>
          <button class="btn btn-primary" style="margin-top:.75rem" onclick="resetSearch()">Reset Pencarian</button>
        </div>`;
        grid.removeAttribute('aria-busy'); return;
      }

      grid.innerHTML = list.map(p=>`
        <div class="col">
          <article class="card">
            <img class="cover" loading="lazy" decoding="async"
                 src="${p.image}"
                 onerror="this.onerror=null;this.src='https://via.placeholder.com/600x400?text=Digineer';"
                 alt="${escapeHTML(p.name)}">
            <div class="card-body">
              <div class="cat">${getCategoryName(p.category)}</div>
              <h3 class="title">${escapeHTML(p.name)}</h3>
              <p class="desc">${escapeHTML(p.description)}</p>
              <div class="meta">
                <div class="price">${IDR.format(p.price)}</div>
                <div class="actions">
                  <button class="btn-buy" aria-label="Tambah ${escapeHTML(p.name)} ke keranjang" onclick="addToCart('${p.id}')">
                    <i class="fas fa-cart-plus"></i> Beli
                  </button>
                  <button class="round wish ${wishlist.includes(p.id)?'active':''}" aria-label="Wishlist ${escapeHTML(p.name)}" onclick="toggleWishlist('${p.id}')">
                    <i class="${wishlist.includes(p.id)?'fas':'far'} fa-heart"></i>
                  </button>
                </div>
              </div>
            </div>
          </article>
        </div>`).join('');

      grid.removeAttribute('aria-busy');
    }
    function displayProducts(){ renderProducts(); syncStateToURL(); }

    /* ---------- Filter & Search ---------- */
    function filterProducts(cat, el){
      currentFilter=cat;
      document.querySelectorAll('.chip').forEach(c=>{c.classList.remove('active');c.setAttribute('aria-selected','false')});
      if(el){ el.classList.add('active'); el.setAttribute('aria-selected','true'); }
      displayProducts();
    }
    const onSearch = debounce((q)=>{ currentSearch=(q||'').trim(); displayProducts(); },300);
    function resetSearch(){ currentSearch=''; const i=document.getElementById('searchInput'); if(i) i.value=''; displayProducts(); }

    /* ---------- Cart UX & A11y ---------- */
    const overlay = document.getElementById('overlay');
    const cartEl = document.getElementById('cart');
    let lastFocused=null;

    function toggleCart(){
      const willOpen = !cartEl.classList.contains('active');
      cartEl.classList.toggle('active');
      overlay.classList.toggle('active');
      document.body.style.overflow = willOpen ? 'hidden' : '';
      if(willOpen){
        lastFocused=document.activeElement;
        const f=cartEl.querySelector('button,[href],input'); if(f) f.focus();
        document.addEventListener('keydown',cartKeys);
      }else{
        document.removeEventListener('keydown',cartKeys);
        if(lastFocused) lastFocused.focus();
      }
    }
    function cartKeys(e){ if(e.key==='Escape') toggleCart(); }

    function addToCart(id){
      const p=products.find(x=>x.id===id);
      const ex=cart.find(x=>x.id===id);
      if(ex){ ex.quantity+=1; } else { cart.push({...p,quantity:1}); }
      localStorage.setItem('digineer-cart', JSON.stringify(cart));
      updateCartUI();
      showNotification(`"${p.name}" ditambahkan ke keranjang! üõí`, 'success');
    }
    function updateCartUI(){
      document.getElementById('cartBadge').textContent = cart.reduce((s,i)=>s+i.quantity,0);
      const box=document.getElementById('cartItems');
      const totalEl=document.getElementById('cartTotal');
      if(cart.length===0){
        box.innerHTML = `<div style="text-align:center;color:#62707f">
          <p>Keranjang kosong</p>
          <button class="btn btn-primary" style="margin-top:.75rem" onclick="toggleCart(); scrollToProducts()">Lihat Layanan</button>
        </div>`;
        totalEl.textContent = IDR.format(0); return;
      }
      box.innerHTML = cart.map(i=>`
        <div class="cart-i">
          <img src="${i.image}" alt="${escapeHTML(i.name)}">
          <div style="flex:1">
            <div style="font-weight:800">${escapeHTML(i.name)}</div>
            <div style="color:#0a8f7e;font-weight:900">${IDR.format(i.price)} √ó ${i.quantity}</div>
            <div style="display:flex;gap:.5rem;margin-top:.5rem;align-items:center">
              <button class="icon-btn" aria-label="Kurangi ${escapeHTML(i.name)}" onclick="updateQty('${i.id}', ${i.quantity-1})" ${i.quantity<=1?'disabled':''}><i class="fas fa-minus"></i></button>
              <span aria-live="polite">${i.quantity}</span>
              <button class="icon-btn" aria-label="Tambah ${escapeHTML(i.name)}" onclick="updateQty('${i.id}', ${i.quantity+1})"><i class="fas fa-plus"></i></button>
              <button class="icon-btn" aria-label="Hapus ${escapeHTML(i.name)}" onclick="removeFromCart('${i.id}')" style="margin-left:auto;color:var(--error)"><i class="fas fa-trash"></i></button>
            </div>
          </div>
        </div>`).join('');
      const total = cart.reduce((s,i)=>s+(i.price*i.quantity),0);
      totalEl.textContent = IDR.format(total);
    }
    function updateQty(id,n){ if(n<1){ removeFromCart(id); return; } const it=cart.find(x=>x.id===id); if(it){ it.quantity=n; localStorage.setItem('digineer-cart',JSON.stringify(cart)); updateCartUI(); } }
    function removeFromCart(id){ cart=cart.filter(x=>x.id!==id); localStorage.setItem('digineer-cart',JSON.stringify(cart)); updateCartUI(); showNotification('Produk dihapus dari keranjang','success'); }
    function checkout(){
      if(cart.length===0){ showNotification('Keranjang masih kosong!','error'); return; }
      const total=cart.reduce((s,i)=>s+(i.price*i.quantity),0);
      const lines=cart.map(i=>`‚Ä¢ ${i.name} (${i.quantity}x) - ${IDR.format(i.price*i.quantity)}`).join('%0A');
      const msg=`Halo Digineer Store! üëã%0A%0ASaya mau pesan layanan berikut:%0A%0A${lines}%0A%0Aüí∞ *Total: ${IDR.format(total)}*%0A%0ABisa info lebih lanjut mengenai proses order dan pembayaran?`;
      const url=`https://wa.me/${WAPP}?text=${msg}`;
      window.open(url,'_blank');
      showNotification('Mengarahkan ke WhatsApp... üì±','success');
      setTimeout(()=>{ cart=[]; localStorage.setItem('digineer-cart',JSON.stringify(cart)); updateCartUI(); toggleCart(); },1800);
    }

    /* ---------- Wishlist ---------- */
    function toggleWishlist(id){
      const i=wishlist.indexOf(id);
      if(i>-1){ wishlist.splice(i,1); showNotification('Dihapus dari wishlist','success'); }
      else{ wishlist.push(id); showNotification('Ditambahkan ke wishlist! ‚ù§Ô∏è','success'); }
      localStorage.setItem('digineer-wishlist', JSON.stringify(wishlist));
      document.getElementById('wishlistBadge').textContent = wishlist.length;
      displayProducts();
    }

    /* ---------- Notification ---------- */
    function showNotification(message, type='success'){
      const live=document.getElementById('liveRegion'); if(live) live.textContent=message;
      const exist=document.querySelector('.note'); if(exist) exist.remove();
      const n=document.createElement('div'); n.className=`note ${type}`; n.setAttribute('role','status'); n.setAttribute('aria-live','polite');
      n.innerHTML=`<i class="fas fa-${type==='success'?'check':'exclamation'}-circle"></i><span>${message}</span>`;
      document.body.appendChild(n);
      setTimeout(()=>n.classList.add('show'),80);
      setTimeout(()=>{ n.classList.remove('show'); setTimeout(()=>n.remove(),280) }, 2800);
    }

    /* ---------- Helpers ---------- */
    function scrollToProducts(){ document.getElementById('produk').scrollIntoView({behavior:'smooth'}); }

    /* ---------- Init ---------- */
    function init(){
      readStateFromURL();
      showSkeleton();
      setTimeout(displayProducts, 250);
      updateCartUI();
      document.getElementById('wishlistBadge').textContent = wishlist.length;
      document.getElementById('year').textContent = new Date().getFullYear();
      setTimeout(()=>showNotification('Selamat datang di Digineer Store! üöÄ','success'),800);
    }
    document.addEventListener('DOMContentLoaded', init);
  </script>
</body>
</html>
